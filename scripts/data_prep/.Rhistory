testDispersion(sim_plant_model_cat_nb)
AIC(plant_model_cat_base, plant_model_cat_stepAIC, plant_model_cat_pois, plant_model_cat_nb)
anova(plant_model_cat_base, plant_model_cat_nb, test = "Chisq")
set.seed(kmeans_seed)
k = kmeans_k
cv_plant_cat_base <- cv.glm(plant_data, plant_model_cat_base, K = k)
cv_plant_cat_pois <- cv.glm(plant_data, plant_model_cat_pois, K = k)
cv_plant_cat_nb <- cv.glm(plant_data, plant_model_cat_nb, K = k)
# Compare LOOCV error (typically in delta[1])
cv_plant_cat_base$delta
cv_plant_cat_pois$delta
cv_plant_cat_nb$delta
summary(plant_model_cat_nb)
plant_model_com_base = glm(richness ~ ed + contag + shdi, poisson, plant_data)
summary(plant_model_com_base)
plant_model_com_stepAIC = stepAIC(plant_model_com_base, scope = ~ (ed + contag + shdi)^5, direction = "both")
summary(plant_model_com_stepAIC)
AIC(plant_model_com_base, plant_model_com_stepAIC)
plant_model_com_pois_dredge = dredge(glm(richness ~ (ed + contag + shdi)^3, poisson, plant_data))
plant_model_com_pois = get.models(plant_model_com_pois_dredge, 1)[[1]]
summary(plant_model_com_pois)
plant_model_com_nb_dredge = dredge(glm.nb(richness ~ (ed + contag + shdi)^3, plant_data))
plant_model_com_nb = get.models(plant_model_com_nb_dredge, 1)[[1]]
summary(plant_model_com_nb)
AIC(plant_model_com_base, plant_model_com_stepAIC, plant_model_com_pois, plant_model_com_nb)
anova(plant_model_com_base, plant_model_com_nb, test = "Chisq")
set.seed(kmeans_seed)
k = kmeans_k
cv_plant_com_base <- cv.glm(plant_data, plant_model_com_base, K = k)
cv_plant_com_pois <- cv.glm(plant_data, plant_model_com_pois, K = k)
cv_plant_com_nb <- cv.glm(plant_data, plant_model_com_nb, K = k)
# Compare LOOCV error (typically in delta[1])
cv_plant_com_base$delta
cv_plant_com_pois$delta
cv_plant_com_nb$delta
summary(plant_model_com_nb)
plant_model_all_nb_dredge = dredge(glm.nb(richness ~ (gnd_cvr + mat_tr + old_tr + shrb + yng_tr + shdi)^2, insect_data))
plant_model_all_nb = get.models(plant_model_all_nb_dredge, 1)[[1]]
summary(plant_model_all_nb)
AIC(plant_model_cat_nb, plant_model_com_nb, plant_model_all_nb)
set.seed(kmeans_seed)
k = kmeans_k
cv_plant_all_nb <- cv.glm(plant_data, plant_model_all_nb, K = k)
# Compare LOOCV error (typically in delta[1])
cv_plant_cat_nb$delta
cv_plant_com_nb$delta
cv_plant_all_nb$delta
summary(insect_model_cat_nb)
label_percent_of_400 = function(x) paste0(x*0.25, "%")
habitat_structure_predictors_insect <- expand.grid(
shrb = seq(min(habitat_structure_predictors$shrb), max(habitat_structure_predictors$shrb), length.out = 50),
yng_tr = seq(min(habitat_structure_predictors$yng_tr), max(habitat_structure_predictors$yng_tr), length.out = 50)
)
habitat_structure_predictors_insect = habitat_structure_predictors_insect %>%
filter(shrb + yng_tr <= 400)
habitat_structure_predictors_insect$insect_richness = predict(insect_model_cat_nb, habitat_structure_predictors_insect, type="response")
ggplot(habitat_structure_predictors_insect, aes(x = shrb, y = yng_tr, fill = insect_richness)) +
geom_tile() +
scale_fill_viridis_c() +  # Better color scaling
labs(
x = "Shrub cover",
y = "Young tree cover",
fill = "Predicted insect richness") +
scale_y_continuous(label = label_percent_of_400) +
scale_x_continuous(label = label_percent_of_400) +
theme_minimal()
ggsave('output/5/insect_predictor_interactions.jpg')
summary(plant_model_cat_nb)
habitat_structure_predictors_plant <- expand.grid(
gnd_cvr = seq(min(habitat_structure_predictors$gnd_cvr), max(habitat_structure_predictors$gnd_cvr), length.out = 50),
mat_tr = seq(min(habitat_structure_predictors$mat_tr), max(habitat_structure_predictors$mat_tr), length.out = 50),
old_tr = seq(min(habitat_structure_predictors$old_tr), max(habitat_structure_predictors$old_tr), length.out = 50),
shrb = seq(min(habitat_structure_predictors$shrb), max(habitat_structure_predictors$shrb), length.out = 50),
yng_tr = seq(min(habitat_structure_predictors$yng_tr), max(habitat_structure_predictors$yng_tr), length.out = 50)
)
habitat_structure_predictors_plant = habitat_structure_predictors_plant %>%
filter(mat_tr + shrb + gnd_cvr + old_tr + yng_tr <= 400)
habitat_structure_predictors_plant$plant_richness = predict(plant_model_cat_nb, habitat_structure_predictors_plant, type="response")
p1 = ggplot(habitat_structure_predictors_plant, aes(x = gnd_cvr, y = shrb, fill = plant_richness)) +
geom_tile() +
scale_fill_viridis_c() +  # Better color scaling
labs(
x = "Ground cover",
y = "Shrub cover",
fill = "Predicted plant richness") +
scale_y_continuous(label = label_percent_of_400) +
scale_x_continuous(label = label_percent_of_400) +
theme_minimal()
p2 = ggplot(habitat_structure_predictors_plant, aes(x = yng_tr, y = shrb, fill = plant_richness)) +
geom_tile() +
scale_fill_viridis_c() +  # Better color scaling
labs(
x = "Young tree cover",
y = "Shrub cover",
fill = "Predicted plant richness") +
scale_y_continuous(label = label_percent_of_400) +
scale_x_continuous(label = label_percent_of_400) +
theme_minimal()
p3 = ggplot(habitat_structure_predictors_plant, aes(x = mat_tr, y = shrb, fill = plant_richness)) +
geom_tile() +
scale_fill_viridis_c() +  # Better color scaling
labs(
x = "Mature tree cover",
y = "Shrub cover",
fill = "Predicted plant richness") +
scale_y_continuous(label = label_percent_of_400) +
scale_x_continuous(label = label_percent_of_400) +
theme_minimal()
p4 = ggplot(habitat_structure_predictors_plant, aes(x = gnd_cvr, y = old_tr, fill = plant_richness)) +
geom_tile() +
scale_fill_viridis_c() +  # Better color scaling
labs(
x = "Old tree cover",
y = "Shrub cover",
fill = "Predicted plant richness") +
scale_y_continuous(label = label_percent_of_400) +
scale_x_continuous(label = label_percent_of_400) +
theme_minimal()
p5 = ggplot(habitat_structure_predictors_plant, aes(x = yng_tr, y = old_tr, fill = plant_richness)) +
geom_tile() +
scale_fill_viridis_c() +  # Better color scaling
labs(
x = "Old tree tree cover",
y = "Shrub cover",
fill = "Predicted plant richness") +
scale_y_continuous(label = label_percent_of_400) +
scale_x_continuous(label = label_percent_of_400) +
theme_minimal()
legend <- ggpubr::get_legend(
# create some space to the left of the legend
p1
)
title <- ggdraw() +
draw_label(
"Interaction effects of ground cover, shrubs and tree on plant richness",
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
)
pg = plot_grid(
nrow = 2, ncol = 3,
p1 + theme(legend.position="none"),
p2 + theme(legend.position="none"),
p3 + theme(legend.position="none"),
p4 + theme(legend.position="none"),
p5 + theme(legend.position="none"),
legend
)
plot_grid(nrow = 2, ncol = 1, title, pg, rel_heights = c(0.1, 1))
ggsave('output/5/plant_predictor_interactions.jpg')
summary(bird_buf_model_cat_pois)
habitat_structure_predictors_bird <- expand.grid(
shrb = seq(min(habitat_structure_predictors_from_buffer$shrb), max(habitat_structure_predictors_from_buffer$shrb), length.out = 50),
gnd_cvr = seq(min(habitat_structure_predictors_from_buffer$gnd_cvr), max(habitat_structure_predictors_from_buffer$gnd_cvr), length.out = 50)
)
habitat_structure_predictors_bird = habitat_structure_predictors_bird %>%
filter(shrb + gnd_cvr <= 400)
habitat_structure_predictors_bird$bird_richness = predict(bird_buf_model_cat_pois, habitat_structure_predictors_bird, type="response")
ggplot(habitat_structure_predictors_bird, aes(x = shrb, y = gnd_cvr, fill = bird_richness)) +
geom_tile() +
scale_fill_viridis_c() +  # Better color scaling
labs(
x = "Shrub cover",
y = "Ground cover",
fill = "Predicted insect richness") +
scale_y_continuous(label = label_percent_of_400) +
scale_x_continuous(label = label_percent_of_400) +
theme_minimal()
ggsave('output/5/bird_predictor_interactions.jpg')
plant_n <- nrow(plant_data)
plant_pois_lambda <- mean(plant_data$richness)
plant_max_val <- max(plant_data$richness)
# Create ideal Poisson distribution
plant_poisson_df <- data.frame(
richness = 0:plant_max_val,
expected = dpois(0:plant_max_val, plant_pois_lambda) * plant_n,
Distribution = "Poisson"
)
plant_nb_fit <- fitdistr(plant_data$richness, "Negative Binomial")
plant_nb_size <- plant_nb_fit$estimate["size"]
plant_nb_mu <- plant_nb_fit$estimate["mu"]
plant_nb_df <- data.frame(
richness = 0:plant_max_val,
expected = dnbinom(0:plant_max_val, size = plant_nb_size, mu = plant_nb_mu) * plant_n,
Distribution = "Negative Binomial"
)
plant_ideal_models_df <- bind_rows(plant_poisson_df, plant_nb_df)
ggplot(plant_data, aes(x = richness)) +
geom_bar() +
geom_line(data = plant_ideal_models_df, aes(x = richness, y = expected, colour = Distribution), size = 1.2, alpha = 0.5) +
ylab('Number of survey plots') +
xlab('Richness') +
labs(
title = "Plant Richness: Observed vs Ideal Poisson Negative Binomial Fits",
subtitle = paste('mean', round(mean(plant_data$richness), 2), ', var', round(var(plant_data$richness), 2))
)
ggsave('./output/5/plant_richness_distribution.jpg')
insect_n <- nrow(insect_data)
insect_pois_lambda <- mean(insect_data$richness)
insect_max_val <- max(insect_data$richness)
# Create ideal Poisson distribution
insect_poisson_df <- data.frame(
richness = 0:insect_max_val,
expected = dpois(0:insect_max_val, insect_pois_lambda) * insect_n,
Distribution = "Poisson"
)
insect_nb_fit <- fitdistr(insect_data$richness, "Negative Binomial")
insect_nb_size <- insect_nb_fit$estimate["size"]
insect_nb_mu <- insect_nb_fit$estimate["mu"]
insect_nb_df <- data.frame(
richness = 0:insect_max_val,
expected = dnbinom(0:insect_max_val, size = insect_nb_size, mu = insect_nb_mu) * insect_n,
Distribution = "Negative Binomial"
)
insect_ideal_models_df <- bind_rows(insect_poisson_df, insect_nb_df)
ggplot(insect_data, aes(x = richness)) +
geom_bar() +
geom_line(data = insect_ideal_models_df, aes(x = richness, y = expected, colour = Distribution), size = 1.2, alpha = 0.5) +
ylab('Number of survey plots') +
xlab('Richness') +
labs(
title = "Insect Richness: Observed vs Ideal Poisson Negative Binomial Fits",
subtitle = paste('mean', round(mean(insect_data$richness), 2), ', var', round(var(insect_data$richness), 2))
)
ggsave('./output/5/insect_richness_distribution.jpg')
bird_n <- nrow(bird_data_buf)
bird_pois_lambda <- mean(bird_data_buf$richness)
bird_max_val <- max(bird_data_buf$richness)
# Create ideal Poisson distribution
bird_poisson_df <- data.frame(
richness = 0:bird_max_val,
expected = dpois(0:bird_max_val, bird_pois_lambda) * bird_n,
Distribution = "Poisson"
)
bird_nb_fit <- fitdistr(bird_data_buf$richness, "Negative Binomial")
bird_nb_size <- bird_nb_fit$estimate["size"]
bird_nb_mu <- bird_nb_fit$estimate["mu"]
bird_nb_df <- data.frame(
richness = 0:bird_max_val,
expected = dnbinom(0:bird_max_val, size = bird_nb_size, mu = bird_nb_mu) * bird_n,
Distribution = "Negative Binomial"
)
bird_ideal_models_df <- bind_rows(bird_poisson_df, bird_nb_df)
ggplot(bird_data_buf, aes(x = richness)) +
geom_bar() +
geom_line(data = bird_ideal_models_df, aes(x = richness, y = expected, colour = Distribution), size = 1.2, alpha = 0.5) +
ylab('Number of survey plots') +
xlab('Richness') +
labs(
title = "Bird Richness: Observed vs Ideal Poisson Negative Binomial Fits",
subtitle = paste('mean', round(mean(bird_data_buf$richness), 2), ', var', round(var(bird_data_buf$richness), 2))
)
ggsave('./output/5/bird_richness_distribution.jpg')
install.packages("brms")
library('brms')
survey_data_raw = read_csv('./input/2/form-1__survey.after_2_land_use.csv')
all_survey_rows = survey_data_raw$title
length(all_survey_rows)
survey_data_to_species_list = function(df) {
df %>%
unite(concat, -c("title"), sep = ",", remove=T) %>%
separate_rows(concat, convert = TRUE, sep = ",") %>%
filter(!is.na(concat)) %>%
rename(species=concat)
}
insect_survey_data = survey_data_to_species_list(survey_data_raw %>% dplyr::select(title, Insects_Butterflies, Insects_Bumblebees, Insects_Hoverflies, Insects_Other))
insect_survey_data
plant_survey_data = survey_data_to_species_list(survey_data_raw %>% dplyr::select(title, Plants_Trees, Plants_Midstory, Plants_Ferns, Plants_Orchids, Plants_Fungi, Plants_Micro, Plants_Grasses, Plants_Other))
plant_survey_data
bird_survey_data = survey_data_to_species_list(survey_data_raw %>% dplyr::select(title, Birds_Songbirds, Birds_Warblers, Birds_Finches, Birds_Tits, Birds_Crows, Birds_Pigeons, Birds_Aerial, Birds_Other))
bird_survey_data
habitat_structure_predictors = read_csv('input/5/ground_cover_classification-1m.csv') %>% rename(gnd_cvr=herbaceous_coverage, shrb = shrub_coverage, yng_tr = young_tree_coverage, mat_tr = mature_tree_coverage, old_tr = old_tree_coverage)
habitat_structure_predictors
habitat_complexity = read_csv('input/5/ground_cover_fragstat-1m.csv') %>%
dplyr::select(title, metric, value) %>%
pivot_wider(names_from = metric, values_from = value)
habitat_complexity
habitat_complexity %>% filter(is.na(contag)) %>% filter(title %in% all_survey_rows)
habitat_complexity$ed[is.na(habitat_complexity$ed)] = 0
habitat_complexity$shdi[is.na(habitat_complexity$shdi)] = 0
habitat_complexity$contag[is.na(habitat_complexity$contag) & habitat_complexity$shdi == 0] = 0
create_data_for_taxa = function(taxa_df) {
present_records = taxa_df %>%
group_by(title) %>%
summarise(richness = n()) %>%
left_join(habitat_structure_predictors, by = 'title') %>%
left_join(habitat_complexity, by = 'title')
absent_records = data.frame(title = all_survey_rows, richness = 0) %>%
filter(!(title %in% present_records$title)) %>%
left_join(habitat_structure_predictors, by = 'title') %>%
left_join(habitat_complexity, by = 'title')
rbind(present_records, absent_records) %>% ungroup() %>% dplyr::select(-title)
}
create_data_for_taxa(insect_survey_data)
insect_data = create_data_for_taxa(insect_survey_data)
# Use negative binomial family for overdispersion
insect_full_model <- brm(
formula = richness ~ (gnd_cvr + shrb + yng_tr + mat_tr + old_tr)^3,
family = negbinomial(),
data = insect_data,
chains = 4,
cores = 4,
iter = 4000,
control = list(adapt_delta = 0.95)  # increase if needed for complex models
)
# Main effects only
insect_main_model <- brm(richness ~ gnd_cvr + shrb + yng_tr + mat_tr + old_tr, family = negbinomial(), data = insect_data)
# Up to 2-way interactions
insect_int2_model <- brm(y ~ (gnd_cvr + shrb + yng_tr + mat_tr + old_tr)^2, family = negbinomial(), data = insect_data)
# Main effects only
insect_main_model <- brm(richness ~ gnd_cvr + shrb + yng_tr + mat_tr + old_tr, family = negbinomial(), data = insect_data)
# Up to 2-way interactions
insect_int2_model <- brm(richness ~ (gnd_cvr + shrb + yng_tr + mat_tr + old_tr)^2, family = negbinomial(), data = insect_data)
insect_loo_main <- loo(insect_main_model)
insect_loo_int2 <- loo(insect_int2_model)
# Main effects only
insect_main_model <- brm(richness ~ gnd_cvr + shrb + yng_tr + mat_tr + old_tr, family = negbinomial(), data = insect_data)
insect_loo_full <- loo(insect_full_model)
insect_loo_main <- loo(insect_main_model)
insect_loo_full <- loo(insect_full_model)
get_prior(richness ~ (gnd_cvr + shrb + yng_tr + mat_tr + old_tr)^2, family = negbinomial(), data = insect_data)
ggplot(data = insect_data, aes(x = gnd_cover)) + geom_bar()
ggplot(data = insect_data, aes(x = gnd_cvr)) + geom_bar()
insect_data = create_data_for_taxa(insect_survey_data)
priors <- c(
prior(normal(0, 1), class = "b"),           # Shrinks coefficients
prior(normal(0, 2), class = "Intercept"),   # Centered on reasonable scale
prior(exponential(1), class = "shape")      # Positive, interpretable dispersion prior
)
# Use negative binomial family for overdispersion
insect_full_model <- brm(
formula = richness ~ (gnd_cvr + shrb + yng_tr + mat_tr + old_tr)^3,
family = negbinomial(),
data = insect_data,
chains = 4,
cores = 4,
iter = 4000,
control = list(adapt_delta = 0.95),  # increase if needed for complex models
prior = priors
)
View(insect_data)
create_data_for_taxa = function(taxa_df) {
present_records = taxa_df %>%
group_by(title) %>%
summarise(richness = n()) %>%
left_join(habitat_structure_predictors, by = 'title') %>%
left_join(habitat_complexity, by = 'title')
absent_records = data.frame(title = all_survey_rows, richness = 0) %>%
filter(!(title %in% present_records$title)) %>%
left_join(habitat_structure_predictors, by = 'title') %>%
left_join(habitat_complexity, by = 'title')
rbind(present_records, absent_records) %>% ungroup() %>% dplyr::select(-title) %>% mutate(richness_adj = richness + 1)
}
create_data_for_taxa(insect_survey_data)
insect_data = create_data_for_taxa(insect_survey_data)
intercept_center <- log(mean(insect_data$richness_adj))
priors <- c(
# Weak prior for main effects (strong shrinkage)
prior(normal(0, 0.005), class = "b", coef = "gnd_cvr"),
prior(normal(0, 0.005), class = "b", coef = "mat_tr"),
prior(normal(0, 0.005), class = "b", coef = "old_tr"),
prior(normal(0, 0.005), class = "b", coef = "shrb"),
prior(normal(0, 0.005), class = "b", coef = "yng_tr"),
# Less shrinkage for interactions (flexibility)
prior(normal(0, 0.01), class = "b"),  # fallback for all interaction terms
# Center intercept prior on mean log y
prior(normal(intercept_center, 1), class = "Intercept"),
# Prior for overdispersion (shape) parameter
prior(exponential(1), class = "shape")
)
# Use negative binomial family for overdispersion
insect_full_model <- brm(
formula = richness_adj ~ (gnd_cvr + shrb + yng_tr + mat_tr + old_tr)^3,
family = negbinomial(),
data = insect_data,
chains = 4,
cores = 4,
iter = 4000,
control = list(adapt_delta = 0.95),  # increase if needed for complex models
prior = priors
)
insect_data
insect_data = create_data_for_taxa(insect_survey_data)
intercept_center <- log(mean(insect_data$richness_adj))
priors <- c(
# Weak prior for main effects (strong shrinkage)
prior(normal(0, 0.005), class = "b", coef = "gnd_cvr"),
prior(normal(0, 0.005), class = "b", coef = "mat_tr"),
prior(normal(0, 0.005), class = "b", coef = "old_tr"),
prior(normal(0, 0.005), class = "b", coef = "shrb"),
prior(normal(0, 0.005), class = "b", coef = "yng_tr"),
# Less shrinkage for interactions (flexibility)
prior(normal(0, 0.01), class = "b"),  # fallback for all interaction terms
# Center intercept prior on mean log y
prior(normal(intercept_center, 1), class = "Intercept"),
# Prior for overdispersion (shape) parameter
prior(exponential(1), class = "shape")
)
# Use negative binomial family for overdispersion
insect_full_model <- brm(
formula = richness_adj ~ (gnd_cvr + shrb + yng_tr + mat_tr + old_tr)^3,
family = negbinomial(),
data = insect_data,
chains = 4,
cores = 4,
iter = 4000,
control = list(adapt_delta = 0.95),  # increase if needed for complex models
prior = priors
)
intercept_center
intercept_center
insect_data = create_data_for_taxa(insect_survey_data)
intercept_center <- log(mean(insect_data$richness_adj))
priors <- c(
# Weak prior for main effects (strong shrinkage)
prior(normal(0, 0.005), class = "b", coef = "gnd_cvr"),
prior(normal(0, 0.005), class = "b", coef = "mat_tr"),
prior(normal(0, 0.005), class = "b", coef = "old_tr"),
prior(normal(0, 0.005), class = "b", coef = "shrb"),
prior(normal(0, 0.005), class = "b", coef = "yng_tr"),
# Less shrinkage for interactions (flexibility)
prior(normal(0, 0.01), class = "b"),  # fallback for all interaction terms
# Center intercept prior on mean log y
prior(normal(0.58, 1), class = "Intercept"),
# Prior for overdispersion (shape) parameter
prior(exponential(1), class = "shape")
)
# Use negative binomial family for overdispersion
insect_full_model <- brm(
formula = richness_adj ~ (gnd_cvr + shrb + yng_tr + mat_tr + old_tr)^3,
family = negbinomial(),
data = insect_data,
chains = 4,
cores = 4,
iter = 4000,
control = list(adapt_delta = 0.95),  # increase if needed for complex models
prior = priors
)
summary(insect_full_model)
plot(insect_full_model)
log(mean(insect_data$richness_adj))
priors <- c(
# Weak prior for main effects (strong shrinkage)
prior(normal(0, 0.005), class = "b", coef = "gnd_cvr"),
prior(normal(0, 0.005), class = "b", coef = "mat_tr"),
prior(normal(0, 0.005), class = "b", coef = "old_tr"),
prior(normal(0, 0.005), class = "b", coef = "shrb"),
prior(normal(0, 0.005), class = "b", coef = "yng_tr"),
# Less shrinkage for interactions (flexibility)
prior(normal(0, 0.01), class = "b"),  # fallback for all interaction terms
# Center intercept prior on mean log y
prior(normal(0.58, 1), class = "Intercept"),
# Prior for overdispersion (shape) parameter
prior(exponential(1), class = "shape")
)
# Use negative binomial family for overdispersion
insect_full_model <- brm(
formula = richness_adj ~ (gnd_cvr + shrb + yng_tr + mat_tr + old_tr)^3,
family = negbinomial(),
data = insect_data,
chains = 4,
cores = 4,
iter = 4000,
init = 0,
control = list(adapt_delta = 0.95),  # increase if needed for complex models
prior = priors
)
summary(insect_full_model)
plot(insect_full_model)
pp_check(insect_full_model)  #
# Main effects only
insect_main_model <- brm(
formula = richness_adj ~ gnd_cvr + shrb + yng_tr + mat_tr + old_tr,
family = negbinomial(),
data = insect_data,
chains = 4,
cores = 4,
iter = 4000,
init = 0,
control = list(adapt_delta = 0.95),  # increase if needed for complex models
prior = priors
)
summary(insect_main_model)
plot(insect_main_model)
pp_check(insect_main_model)
# Up to 2-way interactions
insect_int2_model <- brm(
formula = richness_adj ~ (gnd_cvr + shrb + yng_tr + mat_tr + old_tr)^2,
family = negbinomial(),
data = insect_data,
chains = 4,
cores = 4,
iter = 4000,
init = 0,
control = list(adapt_delta = 0.95),  # increase if needed for complex models
prior = priors
)
summary(insect_int2_model)
plot(insect_int2_model)
pp_check(insect_int2_model)
insect_loo_main <- loo(insect_main_model)
insect_loo_int2 <- loo(insect_int2_model)
insect_loo_full <- loo(insect_full_model)
loo_compare(insect_loo_main, insect_loo_int2, insect_loo_full)
model_weights(insect_main_model, insect_int2_model, insect_full_model, weights = "stacking")
summary(insect_main_model)
summary(insect_full_model)
